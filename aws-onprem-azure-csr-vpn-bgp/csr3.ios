int gi1
no ip nat outside

int gi2
no ip nat inside

!route for test subnet
ip route 10.100.10.0 255.255.255.0 10.100.1.1

crypto ikev2 proposal to-csr1-proposal
  encryption aes-cbc-256
  integrity sha1
  group 2
  exit

crypto ikev2 policy to-csr1-policy
  proposal to-csr1-proposal
  match address local 10.100.0.4
  exit
  
crypto ikev2 keyring to-csr1-keyring
  peer "Insert CSR1PublicIP"
    address "Insert CSR1PublicIP"
    pre-shared-key Msft123Msft123
    exit
  exit

crypto ikev2 profile to-csr1-profile
  match address local 10.100.0.4
  match identity remote address 10.0.0.4
  authentication remote pre-share
  authentication local  pre-share
  lifetime 3600
  dpd 10 5 on-demand
  keyring local to-csr1-keyring
  exit

crypto ipsec transform-set to-csr1-TransformSet esp-gcm 256 
  mode tunnel
  exit

crypto ipsec profile to-csr1-IPsecProfile
  set transform-set to-csr1-TransformSet
  set ikev2-profile to-csr1-profile
  set security-association lifetime seconds 3600
  exit

int tunnel 11
  ip address 192.168.1.3 255.255.255.255
  tunnel mode ipsec ipv4
  ip tcp adjust-mss 1350
  tunnel source 10.100.0.4
  tunnel destination "Insert CSR1PublicIP"
  tunnel protection ipsec profile to-csr1-IPsecProfile
  exit

!loopback address for testing purposes only
int lo1
ip address 3.3.3.3 255.255.255.255

router bgp 65003
  bgp log-neighbor-changes
  neighbor 192.168.1.1 remote-as 65001
  neighbor 192.168.1.1 ebgp-multihop 255
  neighbor 192.168.1.1 update-source tunnel 11

  address-family ipv4
    network 10.100.0.0 mask 255.255.0.0
    network 3.3.3.3 mask 255.255.255.255

    network 192.168.1.3 mask 255.255.255.255
    neighbor 192.168.1.1 activate    
    exit
  exit

!route BGP peer IP over the tunnel
ip route 192.168.1.1 255.255.255.255 Tunnel 11
ip route 10.100.0.0 255.255.0.0 null0